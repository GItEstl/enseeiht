grammar fr.enseeiht.gls.Game with org.eclipse.xtext.common.Terminals

generate game "http://www.enseeiht.fr/gls/Game"

Jeu:
	'jeu' name=ID
	'dans' territoire=[Territoire]
	'avec' explorateur=[Explorateur]
	// default: difficulte=Moyen
	(=> 'difficulte' difficulte=Difficulte)?
	composants+=Composant*
;

Composant:
	Territoire
	| ComposantTerritoire
	| Personne
	| Explorateur
	| Connaissance
	| ObjetElementaire
	| Condition
	| Choix
	| Action
;

Territoire:
	'territoire' name=ID
	'couvre' composants+=[ComposantTerritoire]+
;

ComposantTerritoire:
	Lieu
	| Chemin
;

Lieu:
	'lieu' name=ID
	// default: possession=null
	(=> 'possede' (=> possessions+=PossessionConditionnee ',')* possessions+=PossessionConditionnee)?
	// default: personnes=null
	(=> 'accueille' personnes+=[Personne]+)?
	// default: type=null
	(=> 'type' type=Extremite)?
	// default: conditions=null
	(=> 'selon' conditions+=[Condition]+)?
	// default: descriptions=null
	(=> 'description' descriptions+=DescriptionConditionnee+)?
;

DescriptionConditionnee:
	// default: conditions=null
	'{'description=STRING'}' (=> 'selon' conditions+=[Condition]+)?
;

Chemin:
	'chemin' name=ID
	'depuis' depart=[Lieu]
	'vers' fin=[Lieu]
	// default: ouverture=ouvert conditionsOuverture=null
	(=> 'ouverture' ouverture=Ouverture (=> 'selon' conditionsOuverture+=[Condition]+)?)?
	// default: obligation=facultatif
	(=> 'passage' obligation=Obligation)?
	// default: visibilite=visible conditionsVisibilite=null
	(=> visibilite=Visibilite (=> 'selon' conditionsVisibilite+=[Condition]+)?)?
	// default: possessions=null
	(=> 'possede' (=> possessions+=PossessionConditionnee ',')* possessions+=PossessionConditionnee)?
;

Personne:
	'personne' name=ID
	// default: passage=facultatif
	(=> 'passage' obligation=Obligation)?
	// default: possessions=null
	(=> 'possede' (=> possessions+=PossessionConditionnee ',')* possessions+=PossessionConditionnee)?
	// default: choix=null
	(=> 'offre' choix+=[Choix]*)?
;

Explorateur:
	'explorateur' name=ID
	// default: possessions=null
	(=> 'possede' (=> possessions+=PossessionConditionnee ',')* possessions+=PossessionConditionnee)?
	'porte' poidsMax=INT
;

Possession:
	connaissance=[Connaissance]
	| Objet
;

PossessionConditionnee:
	// default: conditions=null
	possession=Possession (=> 'selon' conditions+=[Condition]+)?
;

Connaissance:
	'connaissance' name=ID
	// default: visibilite=visible conditionsVisibilite=null
	(visibilite=Visibilite (=> 'selon' conditionsVisibilite+=[Condition]+))?
;

Objet:
	// default: quantite=1
	(=> quantite=INT)? objet=[ObjetElementaire]
;

ObjetElementaire:
	'objet' name=ID
	'mesure' taille=INT
	// default: visibilite=visible conditionsVisibilite=null
	(=> visibilite=Visibilite (=> 'selon' (conditionsVisibilite+=[Condition])+)?)?
	// default: transformabilite=immuable conditionsTransformabilite=null
	(=> transformabilite=Transformabilite conditionsTransformabilite+=Transformation*)?
;

Transformation:
	'selon' conditions+=[Condition]+ 'en' objets+=Objet+
;

Condition:
	'condition' name=ID
	// default: possessions=null
	(=> 'possede' possessions+=Comparaison+)?
	// default: conditions=null
	(=> 'selon' conditions+=[Condition]+)?
	// default: difficulte=null
	(=> 'difficulte' difficulte+=Difficulte+)?
	// On note seulement la probabilite est entre 0 et 100
	// default: probabilte=100
	(=> '(probabilite' probabilite=INT ')')?
;

Comparaison:
	connaissance=[Connaissance]
	| comparateur=Comparateur objet=Objet
;

Choix:
	'choix' name=ID
	// default: actions=null
	(=> 'propose' (actions+=ActionConditionnee ',')* actions+=ActionConditionnee)?
	// Un meme choix ne peut pas etre de depart et de fin
	// default: type=null conditions=null
	(=> 'type' type=Extremite (=> 'selon' conditions+=[Condition]+)?)?
;

ChoixConditionne:
	choix=[Choix]
	// default: conditions=null
	(=> 'selon' conditions+=[Condition]*)?
	// default: choixPrecedents=null
	(=> 'selon' choixPrecedents+=[Choix]*)?
;

Action:
	'action' name=ID
	// default: possessions=null
	(=> 'possede' (=> possessions+=PossessionConditionnee ',')* possessions+=PossessionConditionnee)?
	// default: objetsConsommes=null
	(=> 'consomme' objetsConsommes+=Objet+)?
;

ActionConditionnee:
	action=[Action]
	// default: conditions=null
	(=> 'selon' conditions+=[Condition]*)?
	// default: choixPrecedents=null
	(=> 'selon' choixPrecedents+=[Choix]*)?
	('offre' choixOfferts+=ChoixConditionne)+
;

enum Difficulte:
	Facile='facile'
	| Moyen='moyen'
	| Difficile='difficile'
	;
	
enum Extremite:
	Depart='depart'
	| Fin='fin'
;

enum Visibilite:
	Visible='visible'
	| Invisible='invisible'
;

enum Ouverture:
	Ouvert='ouverture'
	| Ferme='ferme'
;

enum Obligation:
	Obligatoire='obligatoire'
	| Facultatif='facultatif'
;

enum Transformabilite:
	Transformable='transformable'
	| Immuable='immuable'
;

enum Comparateur:
	Egal='exactement'
	| Superieur='plus'
	| Inferieur='moins'
;